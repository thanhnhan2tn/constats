<%@page import="vn.edu.cit.services.UserService"%>
<%@page import="vn.edu.cit.model.*"%>
<%@page import="org.springframework.data.mongodb.core.*"%>
<%@ taglib uri="http://java.sun.com/jsp/jstl/core" prefix="c"%>

<%
	User user = (User) request.getAttribute("user");
%>
<div style="display: none ${display}" id="login-alert"
	class="alert alert-danger col-sm-12">${message}</div>
<ul class="list-server">
	<%
		if (user.getServers() != null && !user.getServers().isEmpty()) {
			for (Server server : user.getServers()) {
				//	Boolean check = false;
				//check Server status
				//if(server.checkStatus()){
	%>
	<li class="col-md-3 server-listed" data-id="<%=server.getServerAddress()%>">
		<div class="main-content panel-group" id="accordion">
			<div class="panel panel-default">
				<div class="panel-heading">
					<div class="panel-title">
						<b><%=(server.getServerName() != null) ? server.getServerName() : server.getServerAddress()%></b>
						<div class="btn-group pull-right" role="group" style="z-index: 99">
							<a type="button" class="dropdown-toggle" data-toggle="dropdown"
								aria-expanded="false" id="services-config"> <i
								class="glyphicon glyphicon-chevron-down"></i>
							</a>
							<ul class="dropdown-menu config" role="menu"
								area-labelledby="services-config">
								<li role="presentation" class="dropdown-header">..:ACTION:..</li>
								<li role="presentation"><a role="menuitem" tabindex="-1"
									href="${pageContext.request.contextPath }/editserver/<%=server.getServerAddress()%>/${cc}">Edit...</a></li>
								<li role="presentation"><a role="menuitem" tabindex="-1"
									href="${pageContext.request.contextPath }/removeserver/<%=server.getServerAddress()%>/${cc}">Remove...</a>
								</li>

							</ul>
						</div>
					</div>
				</div>
				<div class="panel-body">
					<div class="text-center" style="display: block">
						<div class="server-icon">
							<span class="wait"
								style="display: none: text-align:center; margin: auto;"> <img
								src="<c:url value='/resources/themes/default/images/loading.gif'/>" />
							</span> <a class="server-monitor-url" href="" title="#"> <i
								class="fa fa-desktop i-server-icon" title="Server is on"
								style="display: none"></i> <i
								class="fa fa-desktop server-off i-server-icon-off" title="Server is off"
								style="display: none"></i>
							</a>
						</div>
						<div class="control-action" style="display: block; margin: 0 auto">
							<div class="btn-group" role="group" aria-label="...">
								<button type="button" class="btn btn-danger disabled" title="shutdown"
									data-toggle="modal" data-target="#stop">
									<i class="glyphicon glyphicon-off"></i>
								</button>
								<button type="button" class="btn btn-warning disabled"
									onclick="location.href='${pageContext.request.contextPath }/restart/<%=server.getServerAddress()%>/${cc }'"
									title="restart">
									<i class="glyphicon glyphicon-repeat"></i>
								</button>

								<button type="button" class="btn btn-default disabled"
									onclick="location.href='${pageContext.request.contextPath }/services/<%=server.getServerAddress()%>/${cc}'"
									id="services-config">
									<i class="glyphicon glyphicon-cog"></i>
								</button>
							</div>
						</div>
						<!-- //control action -->
					</div>
					<!-- //Showw server  -->
				</div>
				<div class="panel-footer" style="font-size: 10pt">

					<!-- Progress bars -->
					<div class="clearfix">
						<span class="pull-left">CPU</span> <small class="pull-right">70%</small>
					</div>
					<div class="progress xs">
						<div class="progress-bar progress-bar-green" style="width: 70%;"></div>
					</div>

					<div class="clearfix">
						<span class="pull-left">RAM</span> <small class="pull-right">45%
							(0.45/1 GB)</small>
					</div>
					<div class="progress xs">
						<div class="progress-bar progress-bar-red" style="width: 45%;"></div>
					</div>
				</div>
			</div>
		</div>
	</li>
	<%
		}
		}
	%>
</ul>
<!-- Model Stop and Reboot Server -->

<div class="btn-group btn-add"></div>
<!-- AddServer Modal -->
<div class="modal fade" id="stop" tabindex="-1" role="dialog"
	aria-labelledby="myModalLabel" aria-hidden="true">
	<div class="modal-dialog">
		<div class="modal-content">
			<div class="modal-header">
				<button type="button" class="close" data-dismiss="modal" aria-label="Close">
					<span aria-hidden="true">&times;</span>
				</button>
				<h4 class="modal-title" id="myModalLabel">Input Sudoer user and
					password</h4>
			</div>
			<form
				action="${pageContext.request.contextPath }/shutdown/<%=server.getServerAddress()%>/${cc }"
				method="POST" class="form-horizontal">
				<div class="modal-body">
					<div class="form-group">
						<label for="ip" class="col-md-3 control-label">Server Name: *</label>
						<div class="col-md-9">
							<spring:input path="serverName" class="form-control"
								placeholder="Server Name" required="required" />
						</div>
					</div>
					<div class="form-group">
						<label for="ip" class="col-md-3 control-label">IP: *</label>
						<div class="col-md-9">
							<spring:input path="serverAddress" class="ip form-control"
								placeholder="IP Address" required="required" />
						</div>
					</div>
					<!-- Root User vÃ  Pass Disabled -->
					<div class="form-group">
						<label for="ssh-port" class="col-md-3 control-label">SSH Port: *</label>
						<div class="col-md-9">
							<spring:input path="port" class="port form-control"
								placeholder="SSH Port" required="required" />
						</div>
					</div>
					<div style="display: none" id="signup-err"
						class="alert alert-danger col-sm-12 signup-err"></div>
					<hr />
					<div class="form-group">
						<label for="password-svuser" class="col-md-3 control-label">Password
							for "svcontrol"</label>
						<div class="col-md-9">
							<spring:input path="serverPassword" class="port form-control"
								placeholder="Choose a password for the SSH/Monitor user 'svcontrol'"
								required="required" />
						</div>
					</div>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
					<button type="submit" class="btn btn-primary">Save</button>
				</div>
			</form>
		</div>
	</div>
</div>


